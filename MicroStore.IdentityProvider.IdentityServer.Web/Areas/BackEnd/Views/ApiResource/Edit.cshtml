@using MicroStore.IdentityProvider.IdentityServer.Web.Areas.BackEnd.Models.ApiResources;
@model MicroStore.IdentityProvider.IdentityServer.Web.Areas.BackEnd.Models.ApiResources.CreateOrEditApiResourceModel
@{
    ViewData["Title"] = "Edit ApiResource / Backend";
    UIMenuNavigationManager.SetCurrentMenu(IdentityServerMenuStandard.ApiResourceMenu.Edit);
}
<div class="content-wrapper mr-2">
        @Html.AntiForgeryToken()
        <div class="content-header">
            <div class="container-fluid">        
                <abp-row class="mb-2">
                    <abp-column size-sm="_6">
                        <h1 class="m-0">Create Api Resource</h1>
                    </abp-column>
                    <abp-column size-sm="_6">
                        <ol class="breadcrumb float-sm-right">
                            <li class="breadcrumb-item">
                                <button class="btn btn-info" id="SaveButton">
                                    <i class="fas
                                fa-plus-square mr-1"></i> Save
                                </button>
                            </li>
                        </ol>
                    </abp-column>
                </abp-row>
            </div>
        </div>
        <div class="content">
            <div class="container-fluid">
                <div class="text-center mb-3">
                  <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                </div>
                <form asp-action="Edit" id="ApiResourceForm">
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(x=> x.Id, new {id= "ApiResourceId"})
                    <partial name="_CreateOrUpdate.Info" model = "Model" />
                    <partial name="_Api.Scopes" model="Model" />
                </form>
                
                <partial name="Grids/_Grids.ApiResourceSecrets" model="new ApiResourceSecretListViewModel()" />
                <partial name="_Grids.Property" />

            </div>
        </div>
    
</div>

@section Scripts{
    <script src="~/backend/js/apiresource/edit.js"> </script>
    <script src="~/backend/js/grids/propertygrid.js"> </script>
    <script>
        $(document).ready(function(){
            $("#SaveButton").on('click',function(){
                $("#ApiResourceForm").submit();
            });

             propertyGrid.init({
                 parentId : "@(Model.Id)",
                listAction:{
                    url : '@Url.Action("ListApiResourceProperties", new {id = @Model.Id})',
                    type:"POST"
                },
                deleteAction:{
                    url : '@Url.Action("DeleteProperty")',
                    type : "POST"
                },

                createModal :{
                    viewUrl : '@Url.Action("CreatePropertyModal")'
                },

                editModal:{
                    viewUrl : '@Url.Action("EditPropertyModal")'
                }

            })

            $("#ScopeSelect").bootstrapDualListbox();
        })

       
    </script>   
}